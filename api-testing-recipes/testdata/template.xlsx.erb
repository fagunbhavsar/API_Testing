<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:o="urn:schemas-microsoft-com:office:office"
  xmlns:x="urn:schemas-microsoft-com:office:excel"
  xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:html="http://www.w3.org/TR/REC-html40">
  <ss:Styles>
    <Style ss:ID="s22">
      <Font ss:Size="13" />
      <NumberFormat ss:Format="yyyy\-mm\-dd"/>
    </Style>
    <Style ss:ID="s1"><Font ss:Bold="1"/></Style>    
    <Style ss:ID="s2"><Font ss:Size="13" /></Style>    
    <Style ss:ID="s4">
     <Borders>
      <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
      <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
     </Borders>
     <Font x:Family="Swiss" ss:Size="14"  ss:Bold="1"/>
     <Interior ss:Color="#CCFFFF" ss:Pattern="Solid"/>
    </Style>    
    <Style ss:ID="s8">
     <Alignment ss:Horizontal="Center" ss:Vertical="Bottom"/>
     <Font x:Family="Swiss" ss:Size="24" ss:Bold="1"/>
    </Style>
    <Style ss:ID="s23" ss:Name="Currency">
      <Font ss:Size="13" />
      <NumberFormat ss:Format="Currency"/>
    </Style>
  </ss:Styles>
  <Worksheet ss:Name="Sheet1">
    <Table >
      <Column ss:AutoFitWidth="0" ss:Width="82"/>
      <Column ss:AutoFitWidth="0" ss:Width="90"/>
      <Column ss:AutoFitWidth="0" ss:Width="148"/>
      <Column ss:AutoFitWidth="0" ss:Width="90"/>
      <Column ss:AutoFitWidth="0" ss:Width="90"/>
      <Row ss:Height="30">
        <Cell ss:MergeAcross="5" ss:StyleID="s8"><Data ss:Type="String">Invoices Report</Data></Cell>
      </Row>
      
      <Row ss:Height="24"  ss:StyleID="s1">
        <Cell ss:MergeAcross="2" ss:StyleID="s2" ><Data ss:Type="String"><%= @starts_at.strftime('%Y-%m-%d') %> to <%= @ends_at.strftime('%Y-%m-%d') %></Data></Cell>
        <Cell ss:StyleID="s2" ><Data ss:Type="String"><%= @invoices.count %> Invoices</Data></Cell>
        <Cell ss:MergeAcross="2" ss:StyleID="s2"><Data ss:Type="String">Total Amount: $<%= @total_invoice_amount %></Data></Cell>          
      </Row>
      
      <Row ss:Height="20">
        <Cell ss:StyleID="s4"><Data ss:Type="String">Invoice Ref</Data></Cell>
        <Cell ss:StyleID="s4"><Data ss:Type="String">Invoice Date</Data></Cell>
        <Cell ss:StyleID="s4"><Data ss:Type="String">Client</Data></Cell>
        <Cell ss:StyleID="s4"><Data ss:Type="String">Amount</Data></Cell>
        <Cell ss:StyleID="s4"><Data ss:Type="String">Comments</Data></Cell>
      </Row>
      <% @invoices.each do |inv| %>
      <Row  ss:StyleID="s2" ss:Height="18"  >
        <Cell><Data ss:Type="Number"><%= inv.reference_number %></Data></Cell>
        <Cell ss:StyleID="s22"><Data ss:Type="DateTime"><%= inv.invoice_date.strftime("%Y-%m-%d") rescue nil %></Data></Cell>
        <Cell><Data ss:Type="String"><%= inv.client %></Data></Cell>
        <Cell ss:StyleID="s23"><Data ss:Type="Number"><%= inv.total_price  %></Data></Cell>
        <Cell><Data ss:Type="String"><%= inv.comments %></Data></Cell>
      </Row>   
     <% end %>

    </Table>
  </Worksheet>
</Workbook>
